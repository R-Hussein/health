{% extends "base.html" %}

{% block title %}Manage Medicines - {{ client.name }}{% endblock %}

{% block content %}
<div class="header">
    <h2>Manage Medicines - {{ client.name }}</h2>
    <a href="{{ url_for('client_detail', client_id=client.id) }}" class="btn btn-secondary">‚Üê Back to Client</a>
</div>

<div class="action-buttons">
    <a href="{{ url_for('add_medicine_server', client_id=client.id) }}" class="btn btn-primary">
        Add New Medicine
    </a>
</div>

{% if medicines %}
<div class="medicines-list">
    <h3>Current Medicines</h3>
    <table class="medicine-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Side Effects</th>
                <th>Schedule</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for medicine in medicines %}
            <tr>
                <td>{{ medicine.name }}</td>
                <td>{{ medicine.side_effect or '-' }}</td>
                <td>
                    {% if medicine.get_times_list() %}
                        {% if medicine.schedule_type == 'daily' %}
                            Daily at {{ medicine.get_times_list()|join(', ') }}
                        {% else %}
                            {{ medicine.get_days_list()|join(', ') }} at {{ medicine.get_times_list()|join(', ') }}
                        {% endif %}
                    {% else %}
                        No schedule set
                    {% endif %}
                </td>
                <td>
                    <span class="status-badge {{ 'active' if medicine.active else 'inactive' }}">
                        {{ 'Active' if medicine.active else 'Inactive' }}
                    </span>
                </td>
                <td class="actions">
                    <a href="{{ url_for('edit_medicine_server', medicine_id=medicine.id) }}" 
                       class="btn btn-sm btn-outline">Edit</a>
                    <form action="{{ url_for('delete_medicine_server', medicine_id=medicine.id) }}" 
                          method="post" style="display: inline;">
                        <button type="submit" class="btn btn-sm btn-danger" 
                                onclick="return confirm('Are you sure you want to delete this medicine?')">
                            Delete
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="no-data">
    <p>No medicines found for this client.</p>
</div>
{% endif %}

<style>
.medicine-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
}

.medicine-table th,
.medicine-table td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid #ddd;
}

.medicine-table th {
    background-color: #f8f9fa;
    font-weight: 600;
}

.status-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
}

.status-badge.active {
    background-color: #d4edda;
    color: #155724;
}

.status-badge.inactive {
    background-color: #f8d7da;
    color: #721c24;
}

.actions {
    display: flex;
    gap: 8px;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
}

.action-buttons {
    margin-bottom: 2rem;
}
</style>
{% endblock %}
