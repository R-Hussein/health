{% extends "base.html" %}

{% block title %}Edit Medicine - {{ medicine.name }}{% endblock %}

{% block content %}
<div class="header">
    <h2>Edit Medicine - {{ medicine.name }}</h2>
    <a href="{{ url_for('manage_client_medicines', client_id=client.id) }}" class="btn btn-secondary">‚Üê Back to Medicines</a>
</div>

<form method="post" class="medicine-form">
    <div class="form-group">
        <label for="name">Medicine Name *</label>
        <input type="text" id="name" name="name" value="{{ medicine.name }}" required class="form-control">
    </div>
    
    <div class="form-group">
        <label for="side_effect">Side Effects</label>
        <textarea id="side_effect" name="side_effect" class="form-control" rows="3">{{ medicine.side_effect or '' }}</textarea>
    </div>
    
    <div class="form-group">
        <label>
            <input type="checkbox" name="active" {{ 'checked' if medicine.active }}>
            Active
        </label>
    </div>
    
    <div class="form-group">
        <label for="schedule_type">Schedule Type</label>
        <select id="schedule_type" name="schedule_type" class="form-control">
            <option value="daily" {{ 'selected' if medicine.schedule_type == 'daily' }}>Daily</option>
            <option value="weekly" {{ 'selected' if medicine.schedule_type == 'weekly' }}>Specific Days</option>
        </select>
    </div>
    
    <div class="form-group" id="days-group" style="display: {{ 'block' if medicine.schedule_type == 'weekly' else 'none' }};">
        <label>Days of Week</label>
        <div class="days-checkboxes">
            {% for day in ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] %}
            <label class="day-checkbox">
                <input type="checkbox" name="days" value="{{ day }}" {{ 'checked' if day in medicine.get_days_list() }}>
                {{ day }}
            </label>
            {% endfor %}
        </div>
    </div>
    
    <div class="form-group">
        <label for="times">Times (comma-separated, 24h format) *</label>
        <input type="text" id="times" name="times" class="form-control" 
               value="{{ medicine.get_times_list()|join(', ') }}" required>
        <small class="form-text">Example: 08:00, 12:30, 20:00</small>
    </div>
    
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Update Medicine</button>
        <a href="{{ url_for('manage_client_medicines', client_id=client.id) }}" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<script>
document.getElementById('schedule_type').addEventListener('change', function() {
    const daysGroup = document.getElementById('days-group');
    daysGroup.style.display = this.value === 'weekly' ? 'block' : 'none';
});
</script>

<style>
.medicine-form {
    max-width: 600px;
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
}

.form-control {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
}

.days-checkboxes {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.day-checkbox {
    display: flex;
    align-items: center;
    gap: 5px;
}

.form-actions {
    display: flex;
    gap: 10px;
    margin-top: 2rem;
}

.form-text {
    color: #6c757d;
    font-size: 12px;
    margin-top: 4px;
}
</style>
{% endblock %}
